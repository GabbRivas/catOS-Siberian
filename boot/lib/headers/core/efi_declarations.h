//
// Made by Gab Rivas 30/01/25 22:36
//
// Library consisting of efi define declarations present in the
// UEFI specs
//

#ifndef EFI_DECLARATIONS_H
#define EFI_DECLARATIONS_H

#include "efi_data_types.h"

// PE32+ Subsystem types for EFI images
#define EFI_IMAGE_SUBSYSTEM_EFI_APPLICATION          10  // EFI application
#define EFI_IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER  11  // Boot service driver
#define EFI_IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER       12  // Runtime driver

// PE32+ Machine types for EFI images
#define EFI_IMAGE_MACHINE_IA32                       0x014c  // IA-32
#define EFI_IMAGE_MACHINE_IA64                       0x0200  // IA-64
#define EFI_IMAGE_MACHINE_EBC                        0x0EBC  // EFI Byte Code
#define EFI_IMAGE_MACHINE_x64                        0x8664  // x86-64
#define EFI_IMAGE_MACHINE_ARMTHUMB_MIXED             0x01C2  // ARM (mixed Thumb/ARM)
#define EFI_IMAGE_MACHINE_AARCH64                    0xAA64  // AArch64
#define EFI_IMAGE_MACHINE_RISCV32                    0x5032  // RISC-V 32-bit
#define EFI_IMAGE_MACHINE_RISCV64                    0x5064  // RISC-V 64-bit
#define EFI_IMAGE_MACHINE_RISCV128                   0x5128  // RISC-V 128-bit
#define EFI_IMAGE_MACHINE_LOONGARCH32                0x6232  // LoongArch 32-bit
#define EFI_IMAGE_MACHINE_LOONGARCH64                0x6264  // LoongArch 64-bit

// Global Variable GUID
#define EFI_GLOBAL_VARIABLE \
  {0x8BE4DF61, 0x93CA, 0x11d2, \
   {0xAA, 0x0D, 0x00, 0xE0, 0x98, 0x03, 0x2B, 0x8C}}

// Removable media file names for different architectures
#define EFI_REMOVABLE_MEDIA_FILE_NAME_IA32         L"\\EFI\\BOOT\\BOOTIA32.EFI"
#define EFI_REMOVABLE_MEDIA_FILE_NAME_IA64         L"\\EFI\\BOOT\\BOOTIA64.EFI"
#define EFI_REMOVABLE_MEDIA_FILE_NAME_X64          L"\\EFI\\BOOT\\BOOTX64.EFI"
#define EFI_REMOVABLE_MEDIA_FILE_NAME_ARM          L"\\EFI\\BOOT\\BOOTARM.EFI"
#define EFI_REMOVABLE_MEDIA_FILE_NAME_AARCH64      L"\\EFI\\BOOT\\BOOTAA64.EFI"
#define EFI_REMOVABLE_MEDIA_FILE_NAME_RISCV64      L"\\EFI\\BOOT\\BOOTRISCV64.EFI"
#define EFI_REMOVABLE_MEDIA_FILE_NAME_LOONGARCH64  L"\\EFI\\BOOT\\BOOTLOONGARCH64.EFI"

// EFI EVENT TYPES
#define EVT_TIMER 0x80000000
#define EVT_RUNTIME 0x40000000
#define EVT_NOTIFY_WAIT 0x00000100
#define EVT_NOTIFY_SIGNAL 0x00000200
#define EVT_SIGNAL_EXIT_BOOT_SERVICES 0x00000201
#define EVT_SIGNAL_VIRTUAL_ADDRESS_CHANGE 0x60000202

// EFI TPL "TYPES"
#define TPL_APPLICATION 4
#define TPL_CALLBACK 8
#define TPL_NOTIFY 16
#define TPL_HIGH_LEVEL 31

// Hardware error var
#define EFI_HARDWARE_ERROR_VARIABLE\
    {0x414E6BDD,0xE47B,0x47cc,{0xB2,0x44,0xBB,0x61,0x02,0x0C,0xF5,0x16}}

// EFI OPTIONAL PTR
#define EFI_OPTIONAL_PTR 0x00000001

// EFI OS INDICATIONS
#define EFI_OS_INDICATIONS_BOOT_TO_FW_UI                    0x0000000000000001
#define EFI_OS_INDICATIONS_TIMESTAMP_REVOCATION             0x0000000000000002
#define EFI_OS_INDICATIONS_FILE_CAPSULE_DELIVERY_SUPPORTED  0x0000000000000004
#define EFI_OS_INDICATIONS_FMP_CAPSULE_SUPPORTED            0x0000000000000008
#define EFI_OS_INDICATIONS_CAPSULE_RESULT_VAR_SUPPORTED     0x0000000000000010
#define EFI_OS_INDICATIONS_START_OS_RECOVERY                0x0000000000000020
#define EFI_OS_INDICATIONS_START_PLATFORM_RECOVERY          0x0000000000000040
#define EFI_OS_INDICATIONS_JSON_CONFIG_DATA_REFRESH         0x0000000000000080

// EFI EVENT GROUP
#define EFI_EVENT_GROUP_EXIT_BOOT_SERVICES \
{0x27abf055, 0xb1b8, 0x4c26, 0x80, 0x48, 0x74, 0x8f, 0x37,\
0xba, 0xa2, 0xdf}}

#define EFI_EVENT_GROUP_BEFORE_EXIT_BOOT_SERVICES \
{ 0x8be0e274, 0x3970, 0x4b44, { 0x80, 0xc5, 0x1a, 0xb9, 0x50, 0x2f, 0x3b, 0xfc } }

#define EFI_EVENT_GROUP_VIRTUAL_ADDRESS_CHANGE \
{0x13fa7698, 0xc831, 0x49c7, 0x87, 0xea, 0x8f, 0x43, 0xfc,\
0xc2, 0x51, 0x96}

#define EFI_EVENT_GROUP_MEMORY_MAP_CHANGE \
{0x78bee926, 0x692f, 0x48fd, 0x9e, 0xdb, 0x1, 0x42, 0x2e, \
0xf0, 0xd7, 0xab}

#define EFI_EVENT_GROUP_READY_TO_BOOT \
{0x7ce88fb3, 0x4bd7, 0x4679, 0x87, 0xa8, 0xa8, 0xd8, 0xde,\
0xe5,0xd, 0x2b}

#define EFI_EVENT_GROUP_AFTER_READY_TO_BOOT \
{ 0x3a2a00ad, 0x98b9, 0x4cdf, { 0xa4, 0x78, 0x70, 0x27, 0x77, \
0xf1, 0xc1, 0xb } }

#define EFI_EVENT_GROUP_RESET_SYSTEM \
{ 0x62da6a56, 0x13fb, 0x485a, { 0xa8, 0xda, 0xa3, 0xdd, 0x79, 0x12, 0xcb, 0x6b \
} }

// Protocol Handler Services
#define EFI_OPEN_PROTOCOL_BY_HANDLE_PROTOCOL 0x00000001
#define EFI_OPEN_PROTOCOL_GET_PROTOCOL 0x00000002
#define EFI_OPEN_PROTOCOL_TEST_PROTOCOL 0x00000004
#define EFI_OPEN_PROTOCOL_BY_CHILD_CONTROLLER 0x00000008
#define EFI_OPEN_PROTOCOL_BY_DRIVER 0x00000010
#define EFI_OPEN_PROTOCOL_EXCLUSIVE 0x00000020

#endif // EFI_DECLARATIONS_H
